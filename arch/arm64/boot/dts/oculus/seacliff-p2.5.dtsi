#include <dt-bindings/clock/qcom,gcc-kona.h>
#include <dt-bindings/clock/qcom,camcc-kona.h>
#include <dt-bindings/clock/qcom,rpmh.h>
#include <dt-bindings/interrupt-controller/arm-gic.h>

#include "seacliff.dtsi"
#include "seacliff-bcmdhd.dtsi"
#include "seacliff-eye-face-led.dtsi"
#include "seacliff-safetyboss.dtsi"

&aliases {
	hsuart14 = "/soc/qcom,qup_uart@98c000";
};

&bcm_bt_hostwake_default {
	mux {
		pins = "gpio66";
	};
	config {
		pins = "gpio66";
	};
};

&bcm_bt_wake_default {
	mux {
		pins = "gpio10";
	};
	config {
		pins = "gpio10";
	};
};

&bt_bluesleep {
	brcm,bt-wake-gpio = <&tlmm 10 0>;
	brcm,bt-host-wake-gpio = <&tlmm 66 0>;
};

&cam_cci0 {
	pinctrl-0 = <&cci1_active>;
	pinctrl-1 = <&cci1_suspend>;
	gpios = <&tlmm 103 0>,
		<&tlmm 104 0>;
	gpio-req-tbl-num = <0 1>;
	gpio-req-tbl-flags = <1 1>;
	gpio-req-tbl-label = "CCI_I2C_DATA1",
			     "CCI_I2C_CLK1";

	qcom,cam-sensor0 {
		csiphy-sd-index = <2>;
	};
	qcom,cam-sensor1 {
		csiphy-sd-index = <4>;
	};
	qcom,cam-sensor2 {
		csiphy-sd-index = <1>;
	};
	qcom,cam-sensor3 {
		csiphy-sd-index = <5>;
	};
	qcom,cam-sensor4 {
		csiphy-sd-index = <0>;
	};
	qcom,cam-sensor5 {
		csiphy-sd-index = <3>;
	};
};

&cm7120 {
	cm7120,codec_1v8-supply = <&pm8150_l7>;
	cm7120,headphone-det-gpios = <&tlmm 113 0
				   &tlmm 89 0>;
	pinctrl-0 = <&cm7120_codec_ldo_en_default
		&cm7120_codec_reset_default
		&cm7120_headphone_det_default>;
};

&cm7120_snd {
	qcom,msm-mi2s-master = <1>, <1>, <1>, <1>, <0>, <1>;
	qcom,quin-mi2s-gpios = <&quin_mi2s_gpios>;
};

&display_panel_avdd {
	status = "disabled";
};

&dsi_dual_boe_spi_blu_dsc_video {
	qcom,platform-en-gpio = <&tlmm 23 0>;
	qcom,platform-reset-gpio = <&tlmm 101 0>;
	qcom,panel-sec-reset-gpio = <&tlmm 57 0>;
};

&dsi_panel_pwr_supply_lab_ibb {
	qcom,panel-supply-entry@3 {
		qcom,supply-min-voltage = <3120000>;
		qcom,supply-max-voltage = <3120000>;
	};
};

&eye_face_led_default {
	mux {
		pins = "gpio73", "gpio13";
	};

	config {
		pins = "gpio73", "gpio13";
	};
};

&fan_1 {
	fan,tach-gpio = <&tlmm 83 0x0>;
};

&fan_tach_default_1 {
	mux {
		pins = "gpio83";
	};
	config {
		pins = "gpio83";
	};
};

&mdss_dsi_phy0 {
	qcom,platform-phy-drive-strength = <0x0F4 0x1F
		0x0F8 0x1F
		0x0FC 0x1F
		0x020 0x50
		0x110 0x55>;
};

&mdss_dsi_phy1 {
	qcom,platform-phy-drive-strength = <0x0F4 0x1F
		0x0F8 0x1F
		0x0FC 0x1F
		0x020 0x50
		0x110 0x55>;
};

&pm8150_l7 {
	qcom,init-voltage = <1800000>;
	qcom,init-mode = <4>; /* RPMH_REGULATOR_MODE_HPM */
};

&pm8150a_l4 {
	status = "disabled";
};

&pm8150a_l6 {
	status = "disabled";
};

&pm8150a_l9 {
	regulator-max-microvolt = <3000000>;
	qcom,init-voltage = <3000000>;
	qcom,init-mode = <4>; /* RPMH_REGULATOR_MODE_HPM */
};

&pm8150a_l11 {
	qcom,init-mode = <4>; /* RPMH_REGULATOR_MODE_HPM */
	qcom,init-voltage = <3120000>;
};

&pm8150b_adc_tm {
	pcb2_therm@53 {
		label = "pogo_therm";
	};
};

&pm8150b_charger {
	io-channels = <&pm8150b_vadc ADC_USB_IN_V_16>,
		      <&pm8150b_vadc ADC_MID_CHG_DIV6>,
		      <&pm8150b_vadc ADC_USB_IN_I>,
		      <&pm8150b_vadc ADC_SBUx>,
		      <&pm8150b_vadc ADC_VPH_PWR>,
		      <&pm8150b_vadc ADC_CHG_TEMP>,
		      <&pm8150b_vadc ADC_AMUX_THM3_PU2>,
		      <&pm8150b_vadc ADC_GPIO4>;
	io-channel-names = "usb_in_voltage",
			   "mid_voltage",
			   "usb_in_current",
			   "sbux_res",
			   "vph_voltage",
			   "chg_temp",
			   "rblt_res",
			   "psns_res";
	dcin-icl-uv = <40000>;

	pinctrl-names = "default", "boost_5v_active",
			"vdd_vconn_suspend", "vdd_vconn_active";
	pinctrl-0 = <&pmb_boost_5v_ext_default>;
	pinctrl-1 = <&pmb_boost_5v_ext_active>;
	pinctrl-2 = <&pmb_vdd_vconn_suspend>;
	pinctrl-3 = <&pmb_vdd_vconn_active>;

	smb5_otg_boost: qcom,smb5-otg_boost {
		regulator-name = "smb5-otg_boost";
	};
};

&pm8150b_gpios {
	pm8150b_boost_5v_ext {
		pmb_boost_5v_ext_default: pmb_boost_5v_ext_default {
			pins = "gpio2", "gpio5";
			function = "normal";
			input-disable;
			output-enable;
			output-low;
			power-source = <0>;
		};
		pmb_boost_5v_ext_active: pmb_boost_5v_ext_active {
			pins = "gpio2", "gpio5";
			function = "normal";
			input-disable;
			output-enable;
			output-high;
			power-source = <0>;
		};

		pmb_vdd_vconn_suspend: pmb_vdd_vconn_suspend {
			pins = "gpio5";
			function = "normal";
			input-disable;
			output-enable;
			output-low;
			power-source = <0>;
		};

		pmb_vdd_vconn_active: pmb_vdd_vconn_active {
			pins = "gpio5";
			function = "normal";
			input-disable;
			output-enable;
			output-high;
			power-source = <0>;
		};
	};
};

&pm8150b_pdphy {
	otg_boost-supply = <&smb5_otg_boost>;
};

&pm8150b_vadc {
	pcb2_therm@53 {
		label = "pogo_therm";
	};

	psns_vol@15 {
		reg = <ADC_GPIO4>;
		label = "psns_vol";
		qcom,pre-scaling = <1 1>;
	};
};

&pm8150l_adc_tm {
	soc_therm@4e {
		label = "dram_therm";
	};
};

&pm8150l_vadc {
	depth_therm@54 {
		label = "usbc_therm";
	};

	soc_therm@4e {
		label = "dram_therm";
	};
};

&q6core {
	quin_mi2s_gpios: quin_mi2s_gpios {
		compatible = "qcom,msm-cdc-pinctrl";
		pinctrl-names = "aud_active", "aud_sleep";
		pinctrl-0 = <&lpi_i2s1_sck_active
			&lpi_i2s1_sd0_active
			&lpi_i2s1_sd1_active
			&lpi_i2s1_ws_active>;
		pinctrl-1 = <&lpi_i2s1_sck_sleep
			&lpi_i2s1_sd0_sleep
			&lpi_i2s1_sd1_sleep
			&lpi_i2s1_ws_sleep>;
		qcom,lpi-gpios;
	};
};

&qupv3_se0_spi {
	status = "ok";
	qcom,rt;

	oculusnrf@0 {
		status = "okay";
		compatible = "oculus,syncboss";
		reg = <0>;
		spi-max-frequency = <8000000>;

		spi-cpol;
		spi-cpha;

		pinctrl-names = "syncboss_default";
		pinctrl-0 = <&syncboss_reset_default &syncboss_wakeup>;

		oculus,swdflavor = "nrf52832";
		oculus,syncboss-reset  = <&tlmm 5 0>;
		oculus,syncboss-timesync = <&tlmm 68 0>;
		oculus,syncboss-wakeup  = <&tlmm 4 0>;

		oculus,syncboss-use-fastpath;
		oculus,transaction-length = <248>;

		swd@0 {
			compatible = "oculus,swd";

			pinctrl-names = "swd_default";
			pinctrl-0 = <&syncboss_float_swd>;

			oculus,swd-clk = <&tlmm 119 0>;
			oculus,swd-io = <&tlmm 120 0>;

			oculus,swd-flavor = "nrf52832";
			oculus,fw-path = "syncboss_P2_BOARD.bin";
			oculus,flash-block-size = <512>;
			oculus,flash-page-size = <4096>;
			oculus,flash-page-count = <128>;
			oculus,flash-page-retained-count = <3>;
		};
	};
};

&qupv3_se2_spi {
	status = "ok";
	qcom,rt;

	cm7120-spi@0 {
		status = "disabled";
	};

	blu_left {
		compatible = "oculus,seacliff-blu-spi";
		reg = <0x00>;
		spi-max-frequency = <15000000>;
		oculus,blu-irq-gpio = <&tlmm 111 0>;
		oculus,blu-name = "seacliff-left-blu";
		oculus,continuous-splash;
	};
};

&qupv3_se3_2uart {
	status = "ok";

	pinctrl-0 = <&syncboss_uart_active>;
	pinctrl-1 = <&syncboss_uart_sleep_tx &syncboss_uart_sleep_rx>;
};

&qupv3_se4_i2c {
	status = "disabled";
};

&qupv3_se5_2uart {
	status = "disabled";
};

/delete-node/ &bq27z561;

&qupv3_se11_i2c {
	status = "ok";
	qcom,clk-freq-out = <100000>;

	bq27z561: fuel-gauge@55 {
		compatible = "ti,bq27z561";
		reg = <0x55>;
		status = "okay";
	};
};

&qupv3_se13_spi {
	status = "disabled";
};

&qupv3_se14_spi {
	status = "ok";
	qcom,rt;

	blu_right {
		compatible = "oculus,seacliff-blu-spi";
		reg = <0x00>;
		spi-max-frequency = <15000000>;
		oculus,blu-irq-gpio = <&tlmm 59 0>;
		oculus,blu-name = "seacliff-right-blu";
		oculus,continuous-splash;
	};
};

&qupv3_se15_i2c {
	cypd3177: cypd3177@08 {
		compatible = "cy,cypd3177";
		reg = <0x08>;
		status = "ok";
		cy,hpi-gpio = <&tlmm 70 0x0>;
		cy,fault-gpio = <&tlmm 69 0x1>;
		interrupt-parent = <&tlmm>;
		interrupts = <13 2>, <14 1>;
		interrupt-names = "cypd3177_hpi_irq", "cypd3177_fault_irq";
		pinctrl-names = "default";
		pinctrl-0 = <&cypd3177_irq_default>;
	};
};

&qupv3_se16_spi {
	status = "okay";

	cm7120-spi@0 {
		status = "okay";
		compatible = "C-Media,cm7120-spi";
		reg = <0>;
		spi-max-frequency = <24000000>;
	};
};

&qupv3_se17_4uart {
	status = "disabled";
};

&qupv3_se18_spi {
	status = "disabled";
};

&qupv3_se19_spi {
	status = "disabled";
};

&sde_dsi {
	pinctrl-0 = <&seacliff_blu_en_active>;
	pinctrl-1 = <&seacliff_blu_en_suspend>;
	avdd-supply = <>;
};

&sde_dsi1 {
	pinctrl-0 = <>;
	pinctrl-1 = <>;
	avdd-supply = <>;
};

&syncboss_float_swd {
	mux {
		pins = "gpio119", "gpio120";
	};

	config {
		pins = "gpio119", "gpio120";
	};
};

&syncboss_uart_active {
	mux {
		pins = "gpio121", "gpio122";
		function = "qup3";
	};

	config {
		pins = "gpio121", "gpio122";
	};
};

&syncboss_uart_sleep_tx {
	mux {
		pins = "gpio121";
	};

	config {
		pins = "gpio121";
	};
};

&syncboss_uart_sleep_rx {
	mux {
		pins = "gpio122";
	};

	config {
		pins = "gpio122";
	};
};

&thermal_zones {
	dram-usr {
		polling-delay-passive = <0>;
		polling-delay = <0>;
		thermal-governor = "user_space";
		thermal-sensors = <&pm8150l_adc_tm ADC_AMUX_THM2_PU2>;
		trips {
			active-config0 {
				temperature = <125000>;
				hysteresis = <1000>;
				type = "passive";
			};
		};
	};

	pcb2-usr {
		status = "disabled";
	};

	pogo-usr {
		polling-delay-passive = <0>;
		polling-delay = <0>;
		thermal-governor = "user_space";
		thermal-sensors = <&pm8150b_adc_tm ADC_GPIO2_PU2>;
		trips {
			active-config0 {
				temperature = <125000>;
				hysteresis = <1000>;
				type = "passive";
			};
		};
	};

	soc-usr {
		status = "disabled";
	};
};

&tlmm {
	cm7120_headphone_det_default: cm7120_headphone_det_default {
		mux {
			pins = "gpio89", "gpio113";
			function = "gpio";
		};

		config {
			pins = "gpio89", "gpio113";
			drive-strength = <2>;
			input-enable;
			bias-disable;
		};
	};

	cypd3177_irq_default: cypd3177_irq_default {
		mux {
			pins = "gpio70", "gpio69";
			function = "gpio";
		};
		config {
			pins = "gpio70", "gpio69";
			drive-strength = <2>;
			input-enable;
		};
	};

	seacliff_blu_en_active: seacliff_blu_en_active {
		mux {
			pins = "gpio88", "gpio91";
			function = "gpio";
		};

		config {
			pins = "gpio88", "gpio91";
			drive-strength = <8>;
			output-high;
			bias-pull-up;
		};
	};

	seacliff_blu_en_suspend: seacliff_blu_en_suspend {
		mux {
			pins = "gpio88", "gpio91";
			function = "gpio";
		};

		config {
			pins = "gpio88", "gpio91";
			drive-strength = <8>;
			output-low;
			bias-pull-down;
		};
	};
};
